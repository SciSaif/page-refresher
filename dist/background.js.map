{"version":3,"file":"background.js","mappings":"gVAAA,IAAIA,EACAC,GAAU,EAKd,SAAeC,EAAYC,G,yCACvB,MAAMC,QAAgBC,OAAOC,UAAUC,cAAc,CACjDC,OAAQ,CAAEC,MAAON,EAAIO,IACrBC,KAAM,MACqBC,SAASC,cAAc,gBAMlDR,OAAOS,QAAQC,UACfC,QAAQC,MAAMZ,OAAOS,QAAQC,WAIZX,EAAQ,GAAGc,QAG5BF,QAAQG,IAAI,cAIZd,OAAOe,KAAKC,OAAOlB,EAAIO,MAOvBY,aAAatB,GACbK,OAAOkB,cAAcC,OAAO,GAAI,CAC5BC,MAAO,4BACPC,QAAS,uCACTC,QAAS,uBACTC,KAAM,UAEV3B,GAAU,EAGlB,G,CA1CAe,QAAQG,IAAI,iCA+DZd,OAAOe,KAAKS,UAAUC,aAAY,SAAgBrB,EAAOsB,EAAY5B,G,+CAC5DF,IAEO,QAAP,EAAAE,EAAI6B,WAAG,eAAEC,WAAW,wCAIC,aAAtBF,EAAWG,QAEXC,YAAW,KACPjC,EAAYC,EAAI,GACjB,I,OAKXE,OAAO+B,QAAQC,KAAKC,IAAI,WAAW,EAAGrC,cAE9BA,IADAA,C,IAQRI,OAAOS,QAAQyB,UAAUT,aAAY,SACjCU,EACAC,EACAC,G,yCAGA,GAAsB,GAAlBF,EAAQG,OAAgB,CACxB3B,QAAQG,IAAI,WACZlB,GAAU,EAEV,MAAOE,SAAaE,OAAOe,KAAKwB,MAAM,CAClCC,QAAQ,EACRC,eAAe,IAEnB,IAAK3C,EAAK,OACVD,EAAYC,E,MAEZa,QAAQG,IAAI,YACZlB,GAAU,EAEdyC,EAAa,CAAExB,OAAQ,WAC3B,G,OC5GoB","sources":["webpack://chegg-refresh/./background.ts","webpack://chegg-refresh/webpack/startup"],"sourcesContent":["let timerId: any;\r\nlet enabled = false;\r\n\r\nconsole.log(\"Chegg Auto Refresh is running\");\r\n\r\n// function to refresh the page after 5 seconds if the content is found\r\nasync function refreshPage(tab: chrome.tabs.Tab) {\r\n    const results = await chrome.scripting.executeScript({\r\n        target: { tabId: tab.id },\r\n        func: () => {\r\n            const contentFound = !!document.querySelector(\".sc-kMizLa\");\r\n            return contentFound;\r\n        },\r\n    });\r\n    // console.log(\"yooo!: \", results);\r\n\r\n    if (chrome.runtime.lastError) {\r\n        console.error(chrome.runtime.lastError);\r\n        return;\r\n    }\r\n\r\n    const contentFound = results[0].result;\r\n    // If the content is not found, print question found to console\r\n    if (contentFound) {\r\n        console.log(\"refreshing\");\r\n\r\n        // refresh the page after 5 seconds\r\n        // timerId = setTimeout(() => {\r\n        chrome.tabs.reload(tab.id);\r\n        // }, 5000);\r\n    }\r\n    // else if content is found, refresh the page after 5 seconds\r\n    else {\r\n        // console.log(\"Content not found\");\r\n        // If the content is found, clear the timer\r\n        clearTimeout(timerId);\r\n        chrome.notifications.create(\"\", {\r\n            title: \"Found a question for you!\",\r\n            message: \"There is a question waiting for you!\",\r\n            iconUrl: \"/images/chegg-48.png\",\r\n            type: \"basic\",\r\n        });\r\n        enabled = false;\r\n        // alert the user that the content is not found\r\n    }\r\n}\r\n\r\n// // listen for tab activation\r\n// chrome.tabs.onActivated.addListener(async function (activeInfo) {\r\n//     if (!enabled) return;\r\n\r\n//     let queryOptions = { active: true, currentWindow: true };\r\n//     let [tab] = await chrome.tabs.query(queryOptions);\r\n//     if (!tab) {\r\n//         // console.log(\"no tab found\");\r\n//         return;\r\n//     }\r\n//     if (!tab.url?.startsWith(\"https://expert.chegg.com/expertqna\")) {\r\n//         // console.log(\"Not Chegg\");\r\n//         return;\r\n//     }\r\n\r\n//     refreshPage(tab);\r\n// });\r\n\r\n// listen for tab refresh\r\nchrome.tabs.onUpdated.addListener(async function (tabId, changeInfo, tab) {\r\n    if (!enabled) return;\r\n\r\n    if (!tab.url?.startsWith(\"https://expert.chegg.com/expertqna\")) {\r\n        // console.log(\"Not Chegg\");\r\n        return;\r\n    }\r\n    if (changeInfo.status === \"complete\") {\r\n        // console.log(\"tab updated\", changeInfo, tab);\r\n        setTimeout(() => {\r\n            refreshPage(tab);\r\n        }, 10000);\r\n    }\r\n});\r\n\r\n// set enabled to true if the toggle is checked and false if it is not\r\nchrome.storage.sync.get(\"enabled\", ({ enabled }) => {\r\n    if (enabled) {\r\n        enabled = true;\r\n    } else {\r\n        enabled = false;\r\n    }\r\n});\r\n\r\n// Add a message listener to listen for messages from popup.js\r\nchrome.runtime.onMessage.addListener(async function (\r\n    request,\r\n    sender,\r\n    sendResponse\r\n) {\r\n    // If the request action is \"runScript\"\r\n    if (request.action == true) {\r\n        console.log(\"enabled\");\r\n        enabled = true;\r\n        // Get the active tab\r\n        const [tab] = await chrome.tabs.query({\r\n            active: true,\r\n            currentWindow: true,\r\n        });\r\n        if (!tab) return;\r\n        refreshPage(tab);\r\n    } else {\r\n        console.log(\"disabled\");\r\n        enabled = false;\r\n    }\r\n    sendResponse({ result: \"success\" });\r\n});\r\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = {};\n__webpack_modules__[69]();\n"],"names":["timerId","enabled","refreshPage","tab","results","chrome","scripting","executeScript","target","tabId","id","func","document","querySelector","runtime","lastError","console","error","result","log","tabs","reload","clearTimeout","notifications","create","title","message","iconUrl","type","onUpdated","addListener","changeInfo","url","startsWith","status","setTimeout","storage","sync","get","onMessage","request","sender","sendResponse","action","query","active","currentWindow"],"sourceRoot":""}